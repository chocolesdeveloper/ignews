"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.startPolling = void 0;
async function startPolling(fn, validate, interval, maxAttempts) {
    let attempts = 0;
    const checkCondition = (resolve, reject) => {
        Promise.resolve(fn())
            .then((result) => {
            if (validate(result)) {
                resolve(result);
            }
            else if (attempts < maxAttempts) {
                attempts += 1;
                setTimeout(checkCondition, interval, resolve, reject);
            }
            else {
                reject(new Error("AsyncPoller: reached timeout"));
            }
        })
            .catch((error) => {
            reject(error);
        });
    };
    return new Promise(checkCondition);
}
exports.startPolling = startPolling;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG9sbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy91dGlscy9wb2xsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFPLEtBQUssVUFBVSxZQUFZLENBSWhDLEVBQXlCLEVBQ3pCLFFBQXVELEVBQ3ZELFFBQWdCLEVBQ2hCLFdBQW1CO0lBRW5CLElBQUksUUFBUSxHQUFHLENBQUMsQ0FBQztJQUNqQixNQUFNLGNBQWMsR0FBRyxDQUNyQixPQUF3RSxFQUN4RSxNQUFnQyxFQUMxQixFQUFFO1FBQ1IsT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUUsQ0FBQzthQUNsQixJQUFJLENBQUMsQ0FBQyxNQUFNLEVBQUUsRUFBRTtZQUNmLElBQUksUUFBUSxDQUFDLE1BQU0sQ0FBQyxFQUFFO2dCQUNwQixPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7YUFDakI7aUJBQU0sSUFBSSxRQUFRLEdBQUcsV0FBVyxFQUFFO2dCQUNqQyxRQUFRLElBQUksQ0FBQyxDQUFDO2dCQUNkLFVBQVUsQ0FBQyxjQUFjLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxNQUFNLENBQUMsQ0FBQzthQUN2RDtpQkFBTTtnQkFDTCxNQUFNLENBQUMsSUFBSSxLQUFLLENBQUMsOEJBQThCLENBQUMsQ0FBQyxDQUFDO2FBQ25EO1FBQ0gsQ0FBQyxDQUFDO2FBQ0QsS0FBSyxDQUFDLENBQUMsS0FBWSxFQUFFLEVBQUU7WUFDdEIsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2hCLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDO0lBRUYsT0FBTyxJQUFJLE9BQU8sQ0FBa0IsY0FBYyxDQUFDLENBQUM7QUFDdEQsQ0FBQztBQS9CRCxvQ0ErQkMifQ==