"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.MockConfigForm = void 0;
const react_1 = require("react");
const fast_deep_equal_1 = __importDefault(require("fast-deep-equal"));
const theme_ui_1 = require("theme-ui");
const formik_1 = require("formik");
const _1 = require(".");
const consts_1 = require("@lib/consts");
const InputDeleteIcon_1 = __importDefault(require("components/InputDeleteIcon"));
const Preview_1 = __importDefault(require("components/Card/Preview"));
const places_1 = __importDefault(require("./places"));
const createMapsUrl = (points) => `https://google.com/maps/@${points.latitude},${points.longitude}`;
const InputSrc = ({ contentValue, value, onUpdate, onDelete }) => {
    return (<theme_ui_1.Label variant="label.primary" sx={{ display: "block" }}>
      <theme_ui_1.Text as="span">Google Maps Url</theme_ui_1.Text>
      <theme_ui_1.Input value={value} placeholder="https://maps.google.com/@..." onChange={(e) => onUpdate(e.target.value)}/>
      <InputDeleteIcon_1.default onClick={onDelete}/>
      {contentValue ? (<theme_ui_1.Box sx={{
                position: "absolute",
                top: "34px",
                right: "38px",
                color: "textClear",
            }}>
          <span>
            lat:{" "}
            {contentValue.latitude}
          </span>
          &nbsp;&nbsp;
          <span>
            long:{" "}
            {contentValue.longitude}
          </span>
        </theme_ui_1.Box>) : null}
    </theme_ui_1.Label>);
};
const Form = () => {
    var _a;
    const { values, setFieldValue } = formik_1.useFormikContext();
    const contentValue = ((_a = values[consts_1.MockConfigKey]) === null || _a === void 0 ? void 0 : _a.content) || null;
    const [url, setUrl] = react_1.useState(contentValue ? createMapsUrl(contentValue) : "");
    const onUpdate = (points) => {
        setUrl(createMapsUrl(points));
        setFieldValue(consts_1.MockConfigKey, {
            content: points,
        });
    };
    const parseMapUrl = (url) => {
        setUrl(url);
        if (!url) {
            return;
        }
        const res = url.match(/@(.*),(.*),/);
        if (res && res.length === 3) {
            onUpdate({
                latitude: parseFloat(res[1]),
                longitude: parseFloat(res[2]),
            });
        }
    };
    const onDelete = () => {
        setUrl("");
        setFieldValue(consts_1.MockConfigKey, {});
    };
    return (<theme_ui_1.Box>
      <InputSrc contentValue={contentValue} value={url} onUpdate={parseMapUrl} onDelete={onDelete}/>
      <theme_ui_1.Label variant="label.primary" mt={3} mb={2} htmlFor="places">
        Presets
      </theme_ui_1.Label>
      <theme_ui_1.Box sx={{
            display: "grid",
            gridColumnGap: "8px",
            gridTemplateColumns: "1fr 1fr",
        }}>
        {places_1.default.map((place) => (<Preview_1.default key={place.name} title={place.name} imageUrl={place.imageUrl} selected={fast_deep_equal_1.default(place.points, contentValue)} titleSx={{
                fontSize: 2,
                maxWidth: "80%",
            }} sx={{
                mb: 3,
            }} onClick={() => onUpdate(place.points)}/>))}
      </theme_ui_1.Box>
    </theme_ui_1.Box>);
};
Form.initialValues = _1.initialValues;
exports.MockConfigForm = Form;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRm9ybS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2xpYi9tb2RlbHMvY29tbW9uL3dpZGdldHMvR2VvUG9pbnQvTW9jay9Gb3JtLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLGlDQUFpQztBQUNqQyxzRUFBb0M7QUFFcEMsdUNBQXlEO0FBQ3pELG1DQUEwQztBQUUxQyx3QkFBa0M7QUFFbEMsd0NBQTRDO0FBRTVDLGlGQUF5RDtBQUN6RCxzRUFBa0Q7QUFFbEQsc0RBQThCO0FBRTlCLE1BQU0sYUFBYSxHQUFHLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FFL0IsNEJBQTRCLE1BQU0sQ0FBQyxRQUFRLElBQUksTUFBTSxDQUFDLFNBQVMsRUFBRSxDQUFDO0FBRXBFLE1BQU0sUUFBUSxHQUFHLENBQUMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsRUFBRSxFQUFFO0lBQy9ELE9BQU8sQ0FDTCxDQUFDLGdCQUFLLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUN0RDtNQUFBLENBQUMsZUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsZUFBZSxFQUFFLGVBQUksQ0FDckM7TUFBQSxDQUFDLGdCQUFLLENBRUosS0FBSyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQ2IsV0FBVyxDQUFDLDhCQUE4QixDQUUxQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsRUFFNUM7TUFBQSxDQUFDLHlCQUFlLENBRWQsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLEVBRXBCO01BQUEsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQ2QsQ0FBQyxjQUFHLENBQ0YsRUFBRSxDQUFDLENBQUM7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