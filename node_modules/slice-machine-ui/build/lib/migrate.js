"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const str_1 = require("./utils/str");
const uniqid_1 = __importDefault(require("uniqid"));
const files_1 = __importDefault(require("./utils/files"));
const paths_1 = require("./models/paths");
const migrate = (model, info, env, write = true) => {
    const { type, fieldset, "non-repeat": nonRepeat = {}, repeat = {} } = model;
    if (type !== "Slice") {
        return { model, migrated: false };
    }
    const newModel = {
        id: str_1.snakelize(info.sliceName),
        type: "SharedSlice",
        name: info.sliceName,
        description: fieldset,
        variations: [
            {
                id: "default-slice",
                name: "Default slice",
                docURL: "...",
                version: uniqid_1.default(),
                description: fieldset,
                primary: nonRepeat,
                items: repeat,
            },
        ],
    };
    if (write) {
        const modelPath = paths_1.CustomPaths(env.cwd)
            .library(info.from)
            .slice(info.sliceName)
            .model();
        files_1.default.write(modelPath, newModel);
    }
    return { model: newModel, migrated: true };
};
exports.default = migrate;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWlncmF0ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL2xpYi9taWdyYXRlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEscUNBQXdDO0FBQ3hDLG9EQUE0QjtBQUM1QiwwREFBa0M7QUFDbEMsMENBQTZDO0FBRTdDLE1BQU0sT0FBTyxHQUFHLENBQUMsS0FBSyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsS0FBSyxHQUFHLElBQUksRUFBRSxFQUFFO0lBRWpELE1BQU0sRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLFlBQVksRUFBRSxTQUFTLEdBQUcsRUFBRSxFQUFFLE1BQU0sR0FBRyxFQUFFLEVBQUUsR0FBRyxLQUFLLENBQUM7SUFDNUUsSUFBSSxJQUFJLEtBQUssT0FBTyxFQUFFO1FBRXBCLE9BQU8sRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxDQUFDO0tBQ25DO0lBQ0QsTUFBTSxRQUFRLEdBQUc7UUFFZixFQUFFLEVBQUUsZUFBUyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUM7UUFDN0IsSUFBSSxFQUFFLGFBQWE7UUFFbkIsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTO1FBRXBCLFdBQVcsRUFBRSxRQUFRO1FBQ3JCLFVBQVUsRUFBRTtZQUNWO2dCQUNFLEVBQUUsRUFBRSxlQUFlO2dCQUNuQixJQUFJLEVBQUUsZUFBZTtnQkFDckIsTUFBTSxFQUFFLEtBQUs7Z0JBQ2IsT0FBTyxFQUFFLGdCQUFNLEVBQUU7Z0JBRWpCLFdBQVcsRUFBRSxRQUFRO2dCQUVyQixPQUFPLEVBQUUsU0FBUztnQkFFbEIsS0FBSyxFQUFFLE1BQU07YUFDZDtTQUNGO0tBQ0YsQ0FBQztJQUVGLElBQUksS0FBSyxFQUFFO1FBRVQsTUFBTSxTQUFTLEdBQUcsbUJBQVcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDO2FBRW5DLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO2FBRWxCLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDO2FBQ3JCLEtBQUssRUFBRSxDQUFDO1FBRVgsZUFBSyxDQUFDLEtBQUssQ0FBQyxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUM7S0FDbEM7SUFFRCxPQUFPLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUM7QUFDN0MsQ0FBQyxDQUFDO0FBRUYsa0JBQWUsT0FBTyxDQUFDIn0=