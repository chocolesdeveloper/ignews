"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const react_1 = __importStar(require("react"));
const prop_types_1 = require("prop-types");
const Card_1 = __importDefault(require("./Card"));
const theme_ui_1 = require("theme-ui");
const fa_1 = require("react-icons/fa");
const SelectFieldTypeModal_1 = __importDefault(require("../SelectFieldTypeModal"));
const NewField_1 = __importDefault(require("./Card/components/NewField"));
const ZoneHeader_1 = __importDefault(require("./components/ZoneHeader"));
const EmptyState_1 = __importDefault(require("./components/EmptyState"));
const Zone = ({ Model, store, tabId, title, fields, poolOfFieldsToCheck, widgetsArray, isRepeatable, onDeleteItem, onSaveNewField, onDragEnd, EditModal, onSave, dataTip, getFieldMockConfig, renderHintBase, renderFieldAccessor, }) => {
    const widgetsArrayWithCondUid = (() => {
        const hasUid = !!Object.entries(poolOfFieldsToCheck).find(([, { value }]) => value.type === "UID");
        return hasUid
            ?
                widgetsArray.filter(({ TYPE_NAME }) => TYPE_NAME !== "UID")
            : widgetsArray;
    })();
    const [showHints, setShowHints] = react_1.useState(false);
    const [editModalData, setEditModalData] = react_1.useState({ isOpen: false });
    const [selectModalData, setSelectModalData] = react_1.useState({ isOpen: false });
    const [newFieldData, setNewFieldData] = react_1.useState(null);
    const enterEditMode = (field) => {
        setEditModalData({ isOpen: true, field });
    };
    const enterSelectMode = () => {
        setSelectModalData({ isOpen: true });
    };
    const closeEditModal = () => {
        setEditModalData({ isOpen: false });
    };
    const closeSelectModal = () => setSelectModalData({ isOpen: false });
    const onSelectFieldType = (widgetTypeName) => {
        setNewFieldData({ widgetTypeName, fields });
        setSelectModalData({ isOpen: false });
    };
    const onCancelNewField = () => setNewFieldData(null);
    return (<react_1.Fragment>
      <ZoneHeader_1.default Heading={<theme_ui_1.Heading as="h6">{title}</theme_ui_1.Heading>} Actions={fields.length ? (<react_1.Fragment>
              <theme_ui_1.Button variant="buttons.lightSmall" onClick={() => setShowHints(!showHints)}>
                <fa_1.FaCode style={{
                marginRight: "8px",
                position: "relative",
                top: "2px",
            }}/>{" "}
                {showHints ? "Hide" : "Show"} code snippets
              </theme_ui_1.Button>
              <theme_ui_1.Button ml={2} variant="buttons.darkSmall" onClick={() => enterSelectMode()}>
                <fa_1.FaPlus style={{
                marginRight: "8px",
                position: "relative",
                top: "2px",
            }}/>
                Add a new Field
              </theme_ui_1.Button>
            </react_1.Fragment>) : null}/>
      {!fields.length && !newFieldData && (<EmptyState_1.default onEnterSelectMode={() => enterSelectMode()} zoneName={isRepeatable ? "repeatable" : "static"}/>)}
      <Card_1.default tabId={tabId} isRepeatable={isRepeatable} fields={fields} showHints={showHints} store={store} Model={Model} dataTip={dataTip} title={title} renderFieldAccessor={renderFieldAccessor} renderHintBase={renderHintBase} enterEditMode={enterEditMode} enterSelectMode={enterSelectMode} onDragEnd={onDragEnd} onDeleteItem={onDeleteItem} NewFieldC={() => newFieldData && (<NewField_1.default {...newFieldData} fields={poolOfFieldsToCheck || fields} onSave={(...args) => {
                onSaveNewField(...args);
                setNewFieldData(null);
            }} onCancelNewField={onCancelNewField}/>)}/>
      <EditModal Model={Model} data={editModalData} close={closeEditModal} onSave={onSave} fields={poolOfFieldsToCheck} getFieldMockConfig={getFieldMockConfig}/>
      <SelectFieldTypeModal_1.default data={selectModalData} close={closeSelectModal} onSelect={onSelectFieldType} widgetsArray={widgetsArrayWithCondUid}/>
    </react_1.Fragment>);
};
Zone.propTypes = {
    isRepeatable: prop_types_1.bool,
    Model: prop_types_1.object.isRequired,
    title: prop_types_1.string.isRequired,
    dataTip: prop_types_1.string.isRequired,
    onSave: prop_types_1.func.isRequired,
    onSaveNewField: prop_types_1.func.isRequired,
    onDragEnd: prop_types_1.func.isRequired,
    onDeleteItem: prop_types_1.func.isRequired,
    poolOfFieldsToCheck: prop_types_1.arrayOf(prop_types_1.shape({ key: prop_types_1.string, value: prop_types_1.object })),
    getFieldMockConfig: prop_types_1.func.isRequired,
    renderHintBase: prop_types_1.func.isRequired,
    renderFieldAccessor: prop_types_1.func.isRequired,
    widgetsArray: prop_types_1.array.isRequired,
    fields: prop_types_1.arrayOf(prop_types_1.shape({
        key: prop_types_1.string.isRequired,
        value: prop_types_1.shape({
            config: prop_types_1.object,
            fields: prop_types_1.array,
            type: prop_types_1.string.isRequired,
        }),
    })),
};
exports.default = Zone;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9saWIvYnVpbGRlcnMvY29tbW9uL1pvbmUvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsK0NBQWtEO0FBQ2xELDJDQUErRTtBQUUvRSxrREFBMEI7QUFFMUIsdUNBQTJDO0FBQzNDLHVDQUFnRDtBQUVoRCxtRkFBMkQ7QUFDM0QsMEVBQWtEO0FBRWxELHlFQUFpRDtBQUNqRCx5RUFBaUQ7QUFFakQsTUFBTSxJQUFJLEdBQUcsQ0FBQyxFQUNaLEtBQUssRUFDTCxLQUFLLEVBQ0wsS0FBSyxFQUNMLEtBQUssRUFDTCxNQUFNLEVBQ04sbUJBQW1CLEVBQ25CLFlBQVksRUFDWixZQUFZLEVBQ1osWUFBWSxFQUNaLGNBQWMsRUFDZCxTQUFTLEVBQ1QsU0FBUyxFQUNULE1BQU0sRUFDTixPQUFPLEVBQ1Asa0JBQWtCLEVBQ2xCLGNBQWMsRUFDZCxtQkFBbUIsR0FDcEIsRUFBRSxFQUFFO0lBRUgsTUFBTSx1QkFBdUIsR0FBRyxDQUFDLEdBQUcsRUFBRTtRQUVwQyxNQUFNLE1BQU0sR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLElBQUksQ0FFdkQsQ0FBQyxDQUFDLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxLQUFLLEtBQUssQ0FDeEMsQ0FBQztRQUVGLE9BQU8sTUFBTTtZQUNYLENBQUM7Z0JBQ0MsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsU0FBUyxFQUFFLEVBQUUsRUFBRSxDQUFDLFNBQVMsS0FBSyxLQUFLLENBQUM7WUFDN0QsQ0FBQyxDQUFDLFlBQVksQ0FBQztJQUNuQixDQUFDLENBQUMsRUFBRSxDQUFDO0lBRUwsTUFBTSxDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUMsR0FBRyxnQkFBUSxD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