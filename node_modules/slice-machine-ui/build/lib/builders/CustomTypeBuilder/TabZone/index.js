"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const react_1 = require("react");
const Widgets = __importStar(require("@lib/models/common/widgets/withGroup"));
const EditModal_1 = __importDefault(require("../../common/EditModal"));
const utils_1 = require("@lib/utils");
const str_1 = require("@utils/str");
const Zone_1 = __importDefault(require("../../common/Zone"));
const ctBuilderArray_1 = __importDefault(require("@lib/models/common/widgets/ctBuilderArray"));
const MockConfig_1 = require("@lib/models/common/MockConfig");
const SliceZone_1 = __importDefault(require("../SliceZone"));
const ModalFormCard_1 = __importDefault(require("components/ModalFormCard"));
const TabZone = ({ Model, store, tabId, fields, sliceZone, showHints }) => {
    const [modalIsOpen, setModalIsOpen] = react_1.useState(false);
    const onDeleteItem = (key) => {
        store.deleteWidgetMockConfig(Model.mockConfig, key);
        store.tab(tabId).removeWidget(key);
    };
    const getFieldMockConfig = ({ apiId }) => {
        return MockConfig_1.CustomTypeMockConfig.getFieldMockConfig(Model.mockConfig, apiId);
    };
    const onDeleteTab = () => {
        store.tab(tabId).delete();
    };
    const onSaveNewField = ({ id, widgetTypeName }) => {
        if (utils_1.ensureWidgetTypeExistence(Widgets, widgetTypeName)) {
            return;
        }
        const widget = Widgets[widgetTypeName];
        store.tab(tabId).addWidget(id, widget.create(id));
    };
    const onDragEnd = (result) => {
        if (utils_1.ensureDnDDestination(result)) {
            return;
        }
        store
            .tab(tabId)
            .reorderWidget(result.source.index, result.destination.index);
    };
    const onSave = ({ apiId: previousKey, newKey, value, mockValue }) => {
        if (utils_1.ensureWidgetTypeExistence(Widgets, value.type)) {
            return;
        }
        if (mockValue) {
            store.updateWidgetMockConfig(Model.mockConfig, previousKey, newKey, mockValue);
        }
        else {
            store.deleteWidgetMockConfig(Model.mockConfig, newKey);
        }
        store.tab(tabId).replaceWidget(previousKey, newKey, value);
    };
    const onCreateSliceZone = () => {
        store.tab(tabId).createSliceZone();
    };
    const onDeleteSliceZone = () => {
        store.tab(tabId).deleteSliceZone();
    };
    const onSelectSharedSlices = (keys, preserve = []) => {
        store.tab(tabId).replaceSharedSlices(keys, preserve);
    };
    const onRemoveSharedSlice = (key) => {
        store.tab(tabId).removeSharedSlice(key);
    };
    return (<react_1.Fragment>
      <Zone_1.default tabId={tabId} Model={Model} store={store} title="Static Zone" dataTip={""} fields={fields} poolOfFieldsToCheck={Model.poolOfFieldsToCheck} showHints={showHints} EditModal={EditModal_1.default} widgetsArray={ctBuilderArray_1.default} getFieldMockConfig={getFieldMockConfig} onDeleteItem={onDeleteItem} onSave={onSave} onSaveNewField={onSaveNewField} onDragEnd={onDragEnd} renderHintBase={({ item }) => `data${str_1.transformKeyAccessor(item.key)}`} renderFieldAccessor={(key) => `data${str_1.transformKeyAccessor(key)}`}/>
      <SliceZone_1.default tabId={tabId} sliceZone={sliceZone} onDelete={onDeleteSliceZone} onRemoveSharedSlice={onRemoveSharedSlice} onCreateSliceZone={onCreateSliceZone} onSelectSharedSlices={onSelectSharedSlices}/>
      <ModalFormCard_1.default isOpen={modalIsOpen} content={{ title: "Edit Tab" }} close={() => setModalIsOpen(false)}/>
    </react_1.Fragment>);
};
exports.default = TabZone;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9saWIvYnVpbGRlcnMvQ3VzdG9tVHlwZUJ1aWxkZXIvVGFiWm9uZS9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxpQ0FBMkM7QUFDM0MsOEVBQWdFO0FBQ2hFLHVFQUErQztBQUUvQyxzQ0FBNkU7QUFFN0Usb0NBQWtEO0FBRWxELDZEQUFxQztBQUVyQywrRkFBdUU7QUFDdkUsOERBQXFFO0FBRXJFLDZEQUFxQztBQUVyQyw2RUFBcUQ7QUFFckQsTUFBTSxPQUFPLEdBQUcsQ0FBQyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLEVBQUUsRUFBRTtJQUN4RSxNQUFNLENBQUMsV0FBVyxFQUFFLGNBQWMsQ0FBQyxHQUFHLGdCQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7SUFFdEQsTUFBTSxZQUFZLEdBQUcsQ0FBQyxHQUFHLEVBQUUsRUFBRTtRQUUzQixLQUFLLENBQUMsc0JBQXNCLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUVwRCxLQUFLLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNyQyxDQUFDLENBQUM7SUFFRixNQUFNLGtCQUFrQixHQUFHLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFO1FBRXZDLE9BQU8saUNBQW9CLENBQUMsa0JBQWtCLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUMsQ0FBQztJQUMxRSxDQUFDLENBQUM7SUFHRixNQUFNLFdBQVcsR0FBRyxHQUFHLEVBQUU7UUFFdkIsS0FBSyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUM1QixDQUFDLENBQUM7SUFFRixN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