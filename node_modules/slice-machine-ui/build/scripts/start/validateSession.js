"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.validateSession = void 0;
const preferWroomBase_1 = __importDefault(require("@lib/utils/preferWroomBase"));
const prismic_1 = require("@slicemachine/core/build/prismic");
const node_utils_1 = require("@slicemachine/core/build/node-utils");
function validateSession(cwd) {
    const manifest = node_utils_1.retrieveManifest(cwd);
    const config = prismic_1.PrismicSharedConfigManager.get();
    if (!manifest.exists || !manifest.content)
        return Promise.resolve(null);
    const base = preferWroomBase_1.default(manifest.content.apiEndpoint);
    if (!config.cookies.length)
        return Promise.resolve(null);
    if (base != config.base)
        return Promise.resolve(null);
    return prismic_1.Communication.validateSession(config.cookies, base).catch(() => null);
}
exports.validateSession = validateSession;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsaWRhdGVTZXNzaW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc2NyaXB0cy9zdGFydC92YWxpZGF0ZVNlc3Npb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ0EsaUZBQXlEO0FBQ3pELDhEQUcwQztBQUMxQyxvRUFBdUU7QUFFdkUsU0FBZ0IsZUFBZSxDQUFDLEdBQVc7SUFDekMsTUFBTSxRQUFRLEdBQUcsNkJBQWdCLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDdkMsTUFBTSxNQUFNLEdBQUcsb0NBQTBCLENBQUMsR0FBRyxFQUFFLENBQUM7SUFHaEQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTztRQUFFLE9BQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUV4RSxNQUFNLElBQUksR0FBRyx5QkFBZSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7SUFFM0QsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBTTtRQUFFLE9BQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN6RCxJQUFJLElBQUksSUFBSSxNQUFNLENBQUMsSUFBSTtRQUFFLE9BQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUV0RCxPQUFPLHVCQUFhLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQy9FLENBQUM7QUFiRCwwQ0FhQyJ9