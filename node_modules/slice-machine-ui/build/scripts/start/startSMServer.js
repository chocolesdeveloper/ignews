"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.startSMServer = void 0;
const child_process_1 = require("child_process");
function startSMServer(cwd, port, callback) {
    const smServer = child_process_1.spawn("node", ["../../server/src/index.js"], {
        cwd: __dirname,
        env: {
            ...process.env,
            CWD: cwd,
            PORT: port,
        },
    });
    smServer.stdout.on("data", function (data) {
        const lns = data.toString().split("Server running");
        if (lns.length === 2) {
            callback(lns[1].replace(/\\n/, "").trim());
        }
        else {
            console.log(data.toString());
        }
    });
    smServer.stderr.on("data", function (data) {
        console.log("[slice-machine] " + data.toString());
    });
}
exports.startSMServer = startSMServer;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhcnRTTVNlcnZlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NjcmlwdHMvc3RhcnQvc3RhcnRTTVNlcnZlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxpREFBc0U7QUFFdEUsU0FBZ0IsYUFBYSxDQUMzQixHQUFXLEVBQ1gsSUFBWSxFQUNaLFFBQStCO0lBRS9CLE1BQU0sUUFBUSxHQUFtQyxxQkFBSyxDQUNwRCxNQUFNLEVBQ04sQ0FBQywyQkFBMkIsQ0FBQyxFQUM3QjtRQUNFLEdBQUcsRUFBRSxTQUFTO1FBQ2QsR0FBRyxFQUFFO1lBQ0gsR0FBRyxPQUFPLENBQUMsR0FBRztZQUNkLEdBQUcsRUFBRSxHQUFHO1lBQ1IsSUFBSSxFQUFFLElBQUk7U0FDWDtLQUNGLENBQ0YsQ0FBQztJQUVGLFFBQVEsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxVQUFVLElBQVk7UUFDL0MsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQ3BELElBQUksR0FBRyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDcEIsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7U0FDNUM7YUFBTTtZQUNMLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7U0FDOUI7SUFDSCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxVQUFVLElBQVk7UUFDL0MsT0FBTyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsR0FBRyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztJQUNwRCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUM7QUE5QkQsc0NBOEJDIn0=