"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.migrate = void 0;
const compare_versions_1 = __importDefault(require("compare-versions"));
const core_1 = require("@slicemachine/core");
const versions_1 = __importDefault(require("./versions"));
const run_1 = require("./run");
async function migrate(params) {
    var _a;
    const projectCWD = params.cwd;
    const smConfig = core_1.FileSystem.retrieveManifest(projectCWD);
    const latestMigrationVersion = (_a = smConfig.content) === null || _a === void 0 ? void 0 : _a._latest;
    const migrationsToRun = versions_1.default.filter((m) => {
        return compare_versions_1.default.compare(m.version, latestMigrationVersion || "0.0.41", ">");
    });
    if (!migrationsToRun.length)
        return;
    return run_1.run(migrationsToRun, params);
}
exports.migrate = migrate;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWlncmF0ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL2NoYW5nZWxvZy9taWdyYXRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLHdFQUErQztBQUMvQyw2Q0FBZ0Q7QUFFaEQsMERBQW9DO0FBQ3BDLCtCQUE0QjtBQWFyQixLQUFLLFVBQVUsT0FBTyxDQUFDLE1BQXVCOztJQUNuRCxNQUFNLFVBQVUsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDO0lBQzlCLE1BQU0sUUFBUSxHQUFHLGlCQUFVLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxDQUFDLENBQUM7SUFFekQsTUFBTSxzQkFBc0IsR0FBdUIsTUFBQSxRQUFRLENBQUMsT0FBTywwQ0FBRSxPQUFPLENBQUM7SUFFN0UsTUFBTSxlQUFlLEdBQWdCLGtCQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7UUFDM0QsT0FBTywwQkFBZSxDQUFDLE9BQU8sQ0FDNUIsQ0FBQyxDQUFDLE9BQU8sRUFDVCxzQkFBc0IsSUFBSSxRQUFRLEVBQ2xDLEdBQUcsQ0FDSixDQUFDO0lBQ0osQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU07UUFBRSxPQUFPO0lBQ3BDLE9BQU8sU0FBRyxDQUFDLGVBQWUsRUFBRSxNQUFNLENBQUMsQ0FBQztBQUN0QyxDQUFDO0FBaEJELDBCQWdCQyJ9