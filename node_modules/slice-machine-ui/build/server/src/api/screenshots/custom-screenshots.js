"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const getEnv_1 = __importDefault(require("../services/getEnv"));
const files_1 = __importDefault(require("@lib/utils/files"));
const screenshot_1 = require("@slicemachine/core/build/libraries/screenshot");
const ComponentUI_1 = require("@lib/models/common/ComponentUI");
async function handler(file, body) {
    const { libraryName, sliceName, variationId } = body;
    const { env } = await getEnv_1.default();
    const maybeCustomScreenshot = screenshot_1.resolvePathsToScreenshot({
        paths: [env.cwd],
        from: libraryName,
        sliceName,
        variationId,
    });
    if (maybeCustomScreenshot)
        files_1.default.remove(maybeCustomScreenshot.path);
    const pathToScreenshot = screenshot_1.createPathToScreenshot({
        path: env.cwd,
        from: libraryName,
        sliceName,
        variationId,
        extension: file.type.split("/")[1],
    });
    files_1.default.copy(file.path, pathToScreenshot, { recursive: true });
    return ComponentUI_1.createScreenshotUI(env.baseUrl, pathToScreenshot);
}
exports.default = handler;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3VzdG9tLXNjcmVlbnNob3RzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc2VydmVyL3NyYy9hcGkvc2NyZWVuc2hvdHMvY3VzdG9tLXNjcmVlbnNob3RzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsZ0VBQXdDO0FBQ3hDLDZEQUFxQztBQUVyQyw4RUFJdUQ7QUFDdkQsZ0VBR3dDO0FBR3pCLEtBQUssVUFBVSxPQUFPLENBQ25DLElBQWEsRUFDYixJQUE2QjtJQUU3QixNQUFNLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUUsR0FBRyxJQUFJLENBQUM7SUFDckQsTUFBTSxFQUFFLEdBQUcsRUFBRSxHQUFHLE1BQU0sZ0JBQU0sRUFBRSxDQUFDO0lBRS9CLE1BQU0scUJBQXFCLEdBQUcscUNBQXdCLENBQUM7UUFDckQsS0FBSyxFQUFFLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQztRQUNoQixJQUFJLEVBQUUsV0FBVztRQUNqQixTQUFTO1FBQ1QsV0FBVztLQUNaLENBQUMsQ0FBQztJQUNILElBQUkscUJBQXFCO1FBQUUsZUFBSyxDQUFDLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUVwRSxNQUFNLGdCQUFnQixHQUFHLG1DQUFzQixDQUFDO1FBQzlDLElBQUksRUFBRSxHQUFHLENBQUMsR0FBRztRQUNiLElBQUksRUFBRSxXQUFXO1FBQ2pCLFNBQVM7UUFDVCxXQUFXO1FBQ1gsU0FBUyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBZTtLQUNqRCxDQUFDLENBQUM7SUFFSCxlQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsZ0JBQWdCLEVBQUUsRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztJQUU3RCxPQUFPLGdDQUFrQixDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQztBQUMzRCxDQUFDO0FBMUJELDBCQTBCQyJ9